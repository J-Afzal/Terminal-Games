#pragma once

#include <array>
#include <cstdint>
#include <random>
#include <string>
#include <vector>

#include "games/Game.hpp"
#include "helpers/PageBuilder.hpp"

namespace TerminalGames
{
    class Hangman : public Game
    {
    public:
        /**
         * @brief Construct a new Hangman object.
         *
         * @param onlyUseASCII Whether to use only ASCII characters (true) or to also use ANSI escapes codes (false).
         */
        explicit Hangman(const bool &onlyUseASCII);

    private:
        /**
         * @brief See base class function for details.
         */
        void SetupGame() override;

        /**
         * @brief See base class function for details.
         */
        void UpdateGameInfo() override;

        /**
         * @brief See base class function for details.
         */
        void GetUserOptions() override;

        /**
         * @brief See base class function for details.
         */
        bool IsGameOver() override;

        /**
         * @brief See base class function for details.
         */
        void ToggleCurrentPlayer() override;

        /**
         * @brief See base class function for details.
         */
        bool IsCurrentTurnUsers() override;

        /**
         * @brief See base class function for details.
         */
        void ExecuteUserCommand() override;

        /**
         * @brief See base class function for details.
         */
        void ExecuteComputerCommand() override;

        /**
         * @brief See base class function for details.
         */
        void GameOver() override;

        /**
         * @brief Prompts the user to select how many players will be playing the game.
         */
        void GetPlayerCount();

        /**
         * @brief Prompts the user to select which player the will be playing the game as (only supported if playing
         * against the computer).
         */
        void GetUserPlayerChoice();

        /**
         * @brief Prompts the user to select how the speed of the computer decision making (this does not affect the difficulty
         * of the computer).
         */
        void GetComputerSpeed();

        /**
         * @brief Prompts the user to enter a 3-14 character word (whether the word is actually a word is not checked) when
         * the user is the word setter.
         *
         */
        void GetWordFromUser();

        /**
         * @brief Gets a random word, from the word list loaded during the setup, when the computer is the word setter.
         *
         */
        void GetWordFromComputer();

        /**
         * @brief Checks the single-letter guess against the word, updates the current guess of the word and the error
         * count depending upon if the guess if correct.
         *
         * @param guess A single-letter to check.
         */
        void ExecuteGeneralCommand(const char &guess);

        PageBuilder m_pageBuilder;
        GameInfo m_gameInfo;
        std::default_random_engine m_randomNumberGenerator;
        std::vector<char> m_commandsRemaining;
        std::vector<char> m_incorrectGuesses;
        std::string m_computerSpeedName;
        std::string m_currentGuessOfWord;
        std::string m_playerCount;
        std::string m_wordToBeGuessed;
        uint32_t m_computerSpeed;
        uint32_t m_errorCount;
        uint32_t m_turnCount;
        bool m_hasWinner;
        bool m_userIsGuesser;

        static constexpr uint32_t m_NUMBER_OF_WORDS = 972;
        static inline const std::array<std::string, m_NUMBER_OF_WORDS> m_WORDS = { // NOLINT(cert-err58-cpp,fuchsia-statically-constructed-objects)
            "ABILITY",
            "ABLE",
            "ABOUT",
            "ABOVE",
            "ACCEPT",
            "ACCORDING",
            "ACCOUNT",
            "ACROSS",
            "ACT",
            "ACTION",
            "ACTIVITY",
            "ACTUALLY",
            "ADD",
            "ADDRESS",
            "ADMINISTRATION",
            "ADMIT",
            "ADULT",
            "AFFECT",
            "AFTER",
            "AGAIN",
            "AGAINST",
            "AGE",
            "AGENCY",
            "AGENT",
            "AGO",
            "AGREE",
            "AGREEMENT",
            "AHEAD",
            "AIR",
            "ALL",
            "ALLOW",
            "ALMOST",
            "ALONE",
            "ALONG",
            "ALREADY",
            "ALSO",
            "ALTHOUGH",
            "ALWAYS",
            "AMERICAN",
            "AMONG",
            "AMOUNT",
            "ANALYSIS",
            "AND",
            "ANIMAL",
            "ANOTHER",
            "ANSWER",
            "ANY",
            "ANYONE",
            "ANYTHING",
            "APPEAR",
            "APPLY",
            "APPROACH",
            "AREA",
            "ARGUE",
            "ARM",
            "AROUND",
            "ARRIVE",
            "ART",
            "ARTICLE",
            "ARTIST",
            "ASK",
            "ASSUME",
            "ATTACK",
            "ATTENTION",
            "ATTORNEY",
            "AUDIENCE",
            "AUTHOR",
            "AUTHORITY",
            "AVAILABLE",
            "AVOID",
            "AWAY",
            "BABY",
            "BACK",
            "BAD",
            "BAG",
            "BALL",
            "BANK",
            "BAR",
            "BASE",
            "BEAT",
            "BEAUTIFUL",
            "BECAUSE",
            "BECOME",
            "BED",
            "BEFORE",
            "BEGIN",
            "BEHAVIOUR",
            "BEHIND",
            "BELIEVE",
            "BENEFIT",
            "BEST",
            "BETTER",
            "BETWEEN",
            "BEYOND",
            "BIG",
            "BILL",
            "BILLION",
            "BIT",
            "BLACK",
            "BLOOD",
            "BLUE",
            "BOARD",
            "BODY",
            "BOOK",
            "BORN",
            "BOTH",
            "BOX",
            "BOY",
            "BREAK",
            "BRING",
            "BROTHER",
            "BUDGET",
            "BUILD",
            "BUILDING",
            "BUSINESS",
            "BUT",
            "BUY",
            "CALL",
            "CAMERA",
            "CAMPAIGN",
            "CAN",
            "CANCER",
            "CANDIDATE",
            "CAPITAL",
            "CAR",
            "CARD",
            "CARE",
            "CAREER",
            "CARRY",
            "CASE",
            "CATCH",
            "CAUSE",
            "CELL",
            "CENTER",
            "CENTRAL",
            "CENTURY",
            "CERTAIN",
            "CERTAINLY",
            "CHAIR",
            "CHALLENGE",
            "CHANCE",
            "CHANGE",
            "CHARACTER",
            "CHARGE",
            "CHECK",
            "CHILD",
            "CHOICE",
            "CHOOSE",
            "CHURCH",
            "CITIZEN",
            "CITY",
            "CIVIL",
            "CLAIM",
            "CLASS",
            "CLEAR",
            "CLEARLY",
            "CLOSE",
            "COACH",
            "COLD",
            "COLLECTION",
            "COLLEGE",
            "COLOUR",
            "COME",
            "COMMERCIAL",
            "COMMON",
            "COMMUNITY",
            "COMPANY",
            "COMPARE",
            "COMPUTER",
            "CONCERN",
            "CONDITION",
            "CONFERENCE",
            "CONGRESS",
            "CONSIDER",
            "CONSUMER",
            "CONTAIN",
            "CONTINUE",
            "CONTROL",
            "COST",
            "COULD",
            "COUNTRY",
            "COUPLE",
            "COURSE",
            "COURT",
            "COVER",
            "CREATE",
            "CRIME",
            "CULTURAL",
            "CULTURE",
            "CUP",
            "CURRENT",
            "CUSTOMER",
            "CUT",
            "DARK",
            "DATA",
            "DAUGHTER",
            "DAY",
            "DEAD",
            "DEAL",
            "DEATH",
            "DEBATE",
            "DECADE",
            "DECIDE",
            "DECISION",
            "DEEP",
            "DEFENCE",
            "DEGREE",
            "DEMOCRAT",
            "DEMOCRATIC",
            "DESCRIBE",
            "DESIGN",
            "DESPITE",
            "DETAIL",
            "DETERMINE",
            "DEVELOP",
            "DEVELOPMENT",
            "DIE",
            "DIFFERENCE",
            "DIFFERENT",
            "DIFFICULT",
            "DINNER",
            "DIRECTION",
            "DIRECTOR",
            "DISCOVER",
            "DISCUSS",
            "DISCUSSION",
            "DISEASE",
            "DOCTOR",
            "DOG",
            "DOOR",
            "DOWN",
            "DRAW",
            "DREAM",
            "DRIVE",
            "DROP",
            "DRUG",
            "DURING",
            "EACH",
            "EARLY",
            "EAST",
            "EASY",
            "EAT",
            "ECONOMIC",
            "ECONOMY",
            "EDGE",
            "EDUCATION",
            "EFFECT",
            "EFFORT",
            "EIGHT",
            "EITHER",
            "ELECTION",
            "ELSE",
            "EMPLOYEE",
            "END",
            "ENERGY",
            "ENJOY",
            "ENOUGH",
            "ENTER",
            "ENTIRE",
            "ENVIRONMENT",
            "ENVIRONMENTAL",
            "ESPECIALLY",
            "ESTABLISH",
            "EVEN",
            "EVENING",
            "EVENT",
            "EVER",
            "EVERY",
            "EVERYBODY",
            "EVERYONE",
            "EVERYTHING",
            "EVIDENCE",
            "EXACTLY",
            "EXAMPLE",
            "EXECUTIVE",
            "EXIST",
            "EXPECT",
            "EXPERIENCE",
            "EXPERT",
            "EXPLAIN",
            "EYE",
            "FACE",
            "FACT",
            "FACTOR",
            "FAIL",
            "FALL",
            "FAMILY",
            "FAR",
            "FAST",
            "FATHER",
            "FEAR",
            "FEDERAL",
            "FEEL",
            "FEELING",
            "FEW",
            "FIELD",
            "FIGHT",
            "FIGURE",
            "FILL",
            "FILM",
            "FINAL",
            "FINALLY",
            "FINANCIAL",
            "FIND",
            "FINE",
            "FINGER",
            "FINISH",
            "FIRE",
            "FIRM",
            "FIRST",
            "FISH",
            "FIVE",
            "FLOOR",
            "FLY",
            "FOCUS",
            "FOLLOW",
            "FOOD",
            "FOOT",
            "FOR",
            "FORCE",
            "FOREIGN",
            "FORGET",
            "FORM",
            "FORMER",
            "FORWARD",
            "FOUR",
            "FREE",
            "FRIEND",
            "FROM",
            "FRONT",
            "FULL",
            "FUND",
            "FUTURE",
            "GAME",
            "GARDEN",
            "GAS",
            "GENERAL",
            "GENERATION",
            "GET",
            "GIRL",
            "GIVE",
            "GLASS",
            "GOAL",
            "GOOD",
            "GOVERNMENT",
            "GREAT",
            "GREEN",
            "GROUND",
            "GROUP",
            "GROW",
            "GROWTH",
            "GUESS",
            "GUN",
            "GUY",
            "HAIR",
            "HALF",
            "HAND",
            "HANG",
            "HAPPEN",
            "HAPPY",
            "HARD",
            "HAVE",
            "HEAD",
            "HEALTH",
            "HEAR",
            "HEART",
            "HEAT",
            "HEAVY",
            "HELP",
            "HER",
            "HERE",
            "HERSELF",
            "HIGH",
            "HIM",
            "HIMSELF",
            "HIS",
            "HISTORY",
            "HIT",
            "HOLD",
            "HOME",
            "HOPE",
            "HOSPITAL",
            "HOT",
            "HOTEL",
            "HOUR",
            "HOUSE",
            "HOW",
            "HOWEVER",
            "HUGE",
            "HUMAN",
            "HUNDRED",
            "HUSBAND",
            "IDEA",
            "IDENTIFY",
            "IMAGE",
            "IMAGINE",
            "IMPACT",
            "IMPORTANT",
            "IMPROVE",
            "INCLUDE",
            "INCLUDING",
            "INCREASE",
            "INDEED",
            "INDICATE",
            "INDIVIDUAL",
            "INDUSTRY",
            "INFORMATION",
            "INSIDE",
            "INSTEAD",
            "INSTITUTION",
            "INTEREST",
            "INTERESTING",
            "INTERNATIONAL",
            "INTERVIEW",
            "INTO",
            "INVESTMENT",
            "INVOLVE",
            "ISSUE",
            "ITEM",
            "ITS",
            "ITSELF",
            "JOB",
            "JOIN",
            "JUST",
            "KEEP",
            "KEY",
            "KID",
            "KILL",
            "KIND",
            "KITCHEN",
            "KNOW",
            "KNOWLEDGE",
            "LAND",
            "LANGUAGE",
            "LARGE",
            "LAST",
            "LATE",
            "LATER",
            "LAUGH",
            "LAW",
            "LAWYER",
            "LAY",
            "LEAD",
            "LEADER",
            "LEARN",
            "LEAST",
            "LEAVE",
            "LEFT",
            "LEG",
            "LEGAL",
            "LESS",
            "LET",
            "LETTER",
            "LEVEL",
            "LIE",
            "LIFE",
            "LIGHT",
            "LIKE",
            "LIKELY",
            "LINE",
            "LIST",
            "LISTEN",
            "LITTLE",
            "LIVE",
            "LOCAL",
            "LONG",
            "LOOK",
            "LOSE",
            "LOSS",
            "LOT",
            "LOVE",
            "LOW",
            "MACHINE",
            "MAGAZINE",
            "MAIN",
            "MAINTAIN",
            "MAJOR",
            "MAJORITY",
            "MAKE",
            "MAN",
            "MANAGE",
            "MANAGEMENT",
            "MANAGER",
            "MANY",
            "MARKET",
            "MARRIAGE",
            "MATERIAL",
            "MATTER",
            "MAY",
            "MAYBE",
            "MEAN",
            "MEASURE",
            "MEDIA",
            "MEDICAL",
            "MEET",
            "MEETING",
            "MEMBER",
            "MEMORY",
            "MENTION",
            "MESSAGE",
            "METHOD",
            "MIDDLE",
            "MIGHT",
            "MILITARY",
            "MILLION",
            "MIND",
            "MINUTE",
            "MISS",
            "MISSION",
            "MODEL",
            "MODERN",
            "MOMENT",
            "MONEY",
            "MONTH",
            "MORE",
            "MORNING",
            "MOST",
            "MOTHER",
            "MOUTH",
            "MOVE",
            "MOVEMENT",
            "MOVIE",
            "MRS",
            "MUCH",
            "MUSIC",
            "MUST",
            "MYSELF",
            "NAME",
            "NATION",
            "NATIONAL",
            "NATURAL",
            "NATURE",
            "NEAR",
            "NEARLY",
            "NECESSARY",
            "NEED",
            "NETWORK",
            "NEVER",
            "NEW",
            "NEWS",
            "NEWSPAPER",
            "NEXT",
            "NICE",
            "NIGHT",
            "NONE",
            "NOR",
            "NORTH",
            "NOT",
            "NOTE",
            "NOTHING",
            "NOTICE",
            "NOW",
            "N'T",
            "NUMBER",
            "OCCUR",
            "OFF",
            "OFFER",
            "OFFICE",
            "OFFICER",
            "OFFICIAL",
            "OFTEN",
            "OIL",
            "OLD",
            "ONCE",
            "ONE",
            "ONLY",
            "ONTO",
            "OPEN",
            "OPERATION",
            "OPPORTUNITY",
            "OPTION",
            "ORDER",
            "ORGANIZATION",
            "OTHER",
            "OTHERS",
            "OUR",
            "OUT",
            "OUTSIDE",
            "OVER",
            "OWN",
            "OWNER",
            "PAGE",
            "PAIN",
            "PAINTING",
            "PAPER",
            "PARENT",
            "PART",
            "PARTICIPANT",
            "PARTICULAR",
            "PARTICULARLY",
            "PARTNER",
            "PARTY",
            "PASS",
            "PAST",
            "PATIENT",
            "PATTERN",
            "PAY",
            "PEACE",
            "PEOPLE",
            "PER",
            "PERFORM",
            "PERFORMANCE",
            "PERHAPS",
            "PERIOD",
            "PERSON",
            "PERSONAL",
            "PHONE",
            "PHYSICAL",
            "PICK",
            "PICTURE",
            "PIECE",
            "PLACE",
            "PLAN",
            "PLANT",
            "PLAY",
            "PLAYER",
            "POINT",
            "POLICE",
            "POLICY",
            "POLITICAL",
            "POLITICS",
            "POOR",
            "POPULAR",
            "POPULATION",
            "POSITION",
            "POSITIVE",
            "POSSIBLE",
            "POWER",
            "PRACTICE",
            "PREPARE",
            "PRESENT",
            "PRESIDENT",
            "PRESSURE",
            "PRETTY",
            "PREVENT",
            "PRICE",
            "PRIVATE",
            "PROBABLY",
            "PROBLEM",
            "PROCESS",
            "PRODUCE",
            "PRODUCT",
            "PRODUCTION",
            "PROFESSIONAL",
            "PROFESSOR",
            "PROGRAM",
            "PROJECT",
            "PROPERTY",
            "PROTECT",
            "PROVE",
            "PROVIDE",
            "PUBLIC",
            "PULL",
            "PURPOSE",
            "PUSH",
            "PUT",
            "QUALITY",
            "QUESTION",
            "QUICKLY",
            "QUITE",
            "RACE",
            "RADIO",
            "RAISE",
            "RANGE",
            "RATE",
            "RATHER",
            "REACH",
            "READ",
            "READY",
            "REAL",
            "REALITY",
            "REALIZE",
            "REALLY",
            "REASON",
            "RECEIVE",
            "RECENT",
            "RECENTLY",
            "RECOGNIZE",
            "RECORD",
            "RED",
            "REDUCE",
            "REFLECT",
            "REGION",
            "RELATE",
            "RELATIONSHIP",
            "RELIGIOUS",
            "REMAIN",
            "REMEMBER",
            "REMOVE",
            "REPORT",
            "REPRESENT",
            "REPUBLICAN",
            "REQUIRE",
            "RESEARCH",
            "RESOURCE",
            "RESPOND",
            "RESPONSE",
            "RESPONSIBILITY",
            "REST",
            "RESULT",
            "RETURN",
            "REVEAL",
            "RICH",
            "RIGHT",
            "RISE",
            "RISK",
            "ROAD",
            "ROCK",
            "ROLE",
            "ROOM",
            "RULE",
            "RUN",
            "SAFE",
            "SAME",
            "SAVE",
            "SAY",
            "SCENE",
            "SCHOOL",
            "SCIENCE",
            "SCIENTIST",
            "SCORE",
            "SEA",
            "SEASON",
            "SEAT",
            "SECOND",
            "SECTION",
            "SECURITY",
            "SEE",
            "SEEK",
            "SEEM",
            "SELL",
            "SEND",
            "SENIOR",
            "SENSE",
            "SERIES",
            "SERIOUS",
            "SERVE",
            "SERVICE",
            "SET",
            "SEVEN",
            "SEVERAL",
            "SEX",
            "SEXUAL",
            "SHAKE",
            "SHARE",
            "SHE",
            "SHOOT",
            "SHORT",
            "SHOT",
            "SHOULD",
            "SHOULDER",
            "SHOW",
            "SIDE",
            "SIGN",
            "SIGNIFICANT",
            "SIMILAR",
            "SIMPLE",
            "SIMPLY",
            "SINCE",
            "SING",
            "SINGLE",
            "SISTER",
            "SIT",
            "SITE",
            "SITUATION",
            "SIX",
            "SIZE",
            "SKILL",
            "SKIN",
            "SMALL",
            "SMILE",
            "SOCIAL",
            "SOCIETY",
            "SOLDIER",
            "SOME",
            "SOMEBODY",
            "SOMEONE",
            "SOMETHING",
            "SOMETIMES",
            "SON",
            "SONG",
            "SOON",
            "SORT",
            "SOUND",
            "SOURCE",
            "SOUTH",
            "SOUTHERN",
            "SPACE",
            "SPEAK",
            "SPECIAL",
            "SPECIFIC",
            "SPEECH",
            "SPEND",
            "SPORT",
            "SPRING",
            "STAFF",
            "STAGE",
            "STAND",
            "STANDARD",
            "STAR",
            "START",
            "STATE",
            "STATEMENT",
            "STATION",
            "STAY",
            "STEP",
            "STILL",
            "STOCK",
            "STOP",
            "STORE",
            "STORY",
            "STRATEGY",
            "STREET",
            "STRONG",
            "STRUCTURE",
            "STUDENT",
            "STUDY",
            "STUFF",
            "STYLE",
            "SUBJECT",
            "SUCCESS",
            "SUCCESSFUL",
            "SUCH",
            "SUDDENLY",
            "SUFFER",
            "SUGGEST",
            "SUMMER",
            "SUPPORT",
            "SURE",
            "SURFACE",
            "SYSTEM",
            "TABLE",
            "TAKE",
            "TALK",
            "TASK",
            "TAX",
            "TEACH",
            "TEACHER",
            "TEAM",
            "TECHNOLOGY",
            "TELEVISION",
            "TELL",
            "TEN",
            "TEND",
            "TERM",
            "TEST",
            "THAN",
            "THANK",
            "THAT",
            "THE",
            "THEIR",
            "THEM",
            "THEMSELVES",
            "THEN",
            "THEORY",
            "THERE",
            "THESE",
            "THEY",
            "THING",
            "THINK",
            "THIRD",
            "THIS",
            "THOSE",
            "THOUGH",
            "THOUGHT",
            "THOUSAND",
            "THREAT",
            "THREE",
            "THROUGH",
            "THROUGHOUT",
            "THROW",
            "THUS",
            "TIME",
            "TODAY",
            "TOGETHER",
            "TONIGHT",
            "TOO",
            "TOP",
            "TOTAL",
            "TOUGH",
            "TOWARD",
            "TOWN",
            "TRADE",
            "TRADITIONAL",
            "TRAINING",
            "TRAVEL",
            "TREAT",
            "TREATMENT",
            "TREE",
            "TRIAL",
            "TRIP",
            "TROUBLE",
            "TRUE",
            "TRUTH",
            "TRY",
            "TURN",
            "TWO",
            "TYPE",
            "UNDER",
            "UNDERSTAND",
            "UNIT",
            "UNTIL",
            "UPON",
            "USE",
            "USUALLY",
            "VALUE",
            "VARIOUS",
            "VERY",
            "VICTIM",
            "VIEW",
            "VIOLENCE",
            "VISIT",
            "VOICE",
            "VOTE",
            "WAIT",
            "WALK",
            "WALL",
            "WANT",
            "WAR",
            "WATCH",
            "WATER",
            "WAY",
            "WEAPON",
            "WEAR",
            "WEEK",
            "WEIGHT",
            "WELL",
            "WEST",
            "WESTERN",
            "WHAT",
            "WHATEVER",
            "WHEN",
            "WHERE",
            "WHETHER",
            "WHICH",
            "WHILE",
            "WHITE",
            "WHO",
            "WHOLE",
            "WHOM",
            "WHOSE",
            "WHY",
            "WIDE",
            "WIFE",
            "WILL",
            "WIN",
            "WIND",
            "WINDOW",
            "WISH",
            "WITH",
            "WITHIN",
            "WITHOUT",
            "WOMAN",
            "WONDER",
            "WORD",
            "WORK",
            "WORKER",
            "WORLD",
            "WORRY",
            "WOULD",
            "WRITE",
            "WRITER",
            "WRONG",
            "YARD",
            "YEAH",
            "YEAR",
            "YES",
            "YET",
            "YOU",
            "YOUNG",
            "YOUR",
            "YOURSELF"};
    };
} // namespace TerminalGames
